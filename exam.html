<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exam - Information Technology Proctor</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style.css">

  <style>
    /* 1. Video Background */
    #bg-video {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
    }

    /* 2. Transparent Body */
    body {
      background: transparent !important;
    }

    /* 3. Glass Header & Footer */
    .header-bg, footer {
      background: rgba(15, 23, 42, 0.8) !important;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-color: rgba(255, 255, 255, 0.1) !important;
    }

    /* 4. Glass Effect for Questions (overriding style.css) */
    .card-custom, .pill-custom {
      background: rgba(30, 41, 59, 0.75) !important;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.1) !important;
    }
  </style>
</head>
<body>
  
  <video autoplay muted loop playsinline id="bg-video">
    <source src="Furina.mp4" type="video/mp4">
    Your browser does not support HTML5 video.
  </video>

  <button id="musicToggle" class="btn btn-dark rounded-circle" onclick="toggleAudio()" 
    style="position: fixed; bottom: 20px; right: 20px; z-index: 1000; width: 50px; height: 50px; 
    display: flex; align-items: center; justify-content: center; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.5); border: 2px solid rgba(255,255,255,0.2);">
    <i class="bi bi-volume-mute-fill" id="musicIcon" style="font-size: 1.5rem;"></i>
  </button>

  <header class="header-bg">
    <h1>Exam In Progress</h1>
  </header>

  <main class="container py-4 exam-main">
    <div class="hud-pills">
      <span class="pill-custom" id="examProgress">Questions 0/0</span>
      <span class="pill-custom" id="skippedPill">Check Skipped Questions 0</span>
      <span class="pill-custom" id="examTimer">Time: 00:00</span>
    </div>

  <div id="examQuiz" class="w-100">
      </div>
    </main>

  <footer class="mt-auto">Proverbs 16:28 A fraudulent man sows strife: and a whisperer separates chief friends.</footer>
  
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function toggleAudio() {
      var video = document.getElementById("bg-video");
      var icon = document.getElementById("musicIcon");
      var btn = document.getElementById("musicToggle");

      if (!video) return;

      if (video.muted) {
        // UNMUTE
        video.muted = false;
        video.volume = 1.0;
        
        icon.classList.remove("bi-volume-mute-fill");
        icon.classList.add("bi-volume-up-fill");
        btn.classList.remove("btn-dark");
        btn.classList.add("btn-accent");
        
        var playPromise = video.play();
        if (playPromise !== undefined) {
          playPromise.catch(error => { console.log("Playback prevented:", error); });
        }
      } else {
        // MUTE
        video.muted = true;
        icon.classList.remove("bi-volume-up-fill");
        icon.classList.add("bi-volume-mute-fill");
        btn.classList.remove("btn-accent");
        btn.classList.add("btn-dark");
      }
    }
  </script>

  <div class="modal fade" id="warningModal" tabindex="-1" aria-labelledby="warningModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content modal-content-custom">
        <div class="modal-header modal-header-custom">
          <h5 class="modal-title" id="warningModalLabel">
            <i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>Warning
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center modal-body-custom">
          <div class="warn-text mb-3">⚠ Do not switch tabs or minimize the exam.</div>
          <p id="warningText">This is your first warning. Continuing will restore fullscreen.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-accent" id="continueBtn">Continue Exam</button>
          <button type="button" class="btn btn-secondary" id="exitBtn" data-bs-dismiss="modal">Exit Exam</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="skippedModal" tabindex="-1" aria-labelledby="skippedModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content modal-content-custom">
      <div class="modal-header modal-header-custom">
        <h5 class="modal-title" id="skippedModalLabel">
          <i class="bi bi-skip-forward-circle me-2"></i>Review Skipped Questions
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
    
    <div id="skippedList" class="d-flex flex-wrap gap-2"></div>
</div>
      </div>
    </div>
  </div>
</div>

  <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content modal-content-custom">
        <div class="modal-header modal-header-custom">
          <h5 class="modal-title" id="confirmModalLabel">Confirm Answer</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center modal-body-custom">
          <p id="confirmText">Are you sure you want to submit this answer?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-accent" id="confirmYes">Yes</button>
          <button type="button" class="btn btn-secondary" id="confirmNo" data-bs-dismiss="modal">No</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="duplicateModal" tabindex="-1" aria-labelledby="duplicateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content modal-content-custom">
        <div class="modal-header modal-header-custom">
          <h5 class="modal-title" id="duplicateModalLabel">
            <i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>Duplicate Entry
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center modal-body-custom">
          <div class="warn-text mb-3">⚠ Duplicate Name Detected</div>
          <p id="duplicateText">A record with this name already exists. Please contact your instructor.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-accent" id="duplicateOk" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="errorModalLabel">Error</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                  <div id="errorText" class="alert alert-danger"></div>
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" id="errorOk" data-bs-dismiss="modal">OK</button>
              </div>
          </div>
      </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Global API endpoint for this deployment (set from new Apps Script deploy ID)
    // Placed before runtime script so `exam.js` can read it on load.
    window.ANSWER_API_URL = 'https://script.google.com/macros/s/AKfycby6B9OgDmMNJqGmDNBvF7MJnAaV1wXTnvmzjjCEqn8vIh1zEFx7Izn3jxEJIsvnuXF4/exec';
  </script>
  <script src="scripts/exam.js"></script>
</body>
</html>
